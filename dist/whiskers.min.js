
(function(whiskers){whiskers.cache={};whiskers.render=function(template,context,partials){context=context||{};partials=partials||{};if(!whiskers.cache[template]){whiskers.cache[template]=whiskers.compile(template);}
return whiskers.cache[template](context,partials);};whiskers.compile=function(template){if(template instanceof Function)return template;template=(template||'')+'';template=template.replace(/\\/g,'\\\\').replace(/\'/g,'\\\'').replace(/\n/g,'\\n').replace(/\r/g,'');template=template.replace(/(\\*){![\s\S]*?!}/g,function(str,escapeChar){if(escapeChar)return str.replace('\\\\','');return'';});var stack=[],block;template=template.replace(/(\\*){(?:([\w_.]+)|>([\w_.]+)|for +([\w_]+) +in +([\w_.]+)|if +(not +|)([\w_.]+)|\/(for|if))}/g,function(str,escapeChar,key,partial,iterVar,forKey,ifNot,ifKey,closeStatement,offset,s){if(escapeChar)return str.replace('\\\\','');if(key){if(key=='else'){block=stack[stack.length-1];if(block&&!block.elsed){block.elsed=true;if(block.statement=='if')return'\'}else{b+=\'';if(block.statement=='for')return'\'}if(!g(c,\''+block.key+'\')){b+=\'';}
console.warn('extra {else} ignored');return'';}
return'\'+g(c,\''+key+'\')+\'';}
if(partial)return'\'+r(g(p,\''+partial+'\'),c,p)+\'';if(forKey){stack.push({statement:'for',key:forKey});return'\';var '+iterVar+'A=g(c,\''+forKey+'\');for(var '+iterVar+'I=0;'+iterVar+'I<'+iterVar+'A.length;'+iterVar+'I++){c[\''+iterVar+'\']='+iterVar+'A['+iterVar+'I];c[\'self\']='+iterVar+'A['+iterVar+'I];b+=\'';}
if(ifKey){stack.push({statement:'if'});return'\';if('+(ifNot?'!':'')+'g(c,\''+ifKey+'\')){b+=\'';}
if(closeStatement){block=stack[stack.length-1];if(block&&block.statement==closeStatement){stack.pop();return'\'}b+=\'';}
console.warn('extra {/'+closeStatement+'} ignored');return'';}
return str;});for(var i=stack.length-1;i>-1;i--){block=stack[i];console.warn('extra {'+block.statement+'} closed at end of template');template=template+'\'}b+=\'';}
var fn=new Function('g','r','return function(c,p){var b=\''+template+'\';return b}');return fn(get,whiskers.render);};function get(obj,key){var accessor=key.split('.');for(var i=0,l=accessor.length;i<l;i++){obj=obj[accessor[i]];if(!obj)return'';}
return obj;}}(typeof module=='object'?module.exports:window.whiskers={}));